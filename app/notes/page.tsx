import { fetchNotes } from "@/lib/api";
import NotesClient from "./filter/[...slug]/Notes.client";
import {
  QueryClient,
  dehydrate,
  HydrationBoundary,
} from "@tanstack/react-query";

export default async function NotesPage() {
  const queryClient = new QueryClient();

  // üîπ –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Å —Å–µ—Ä–≤–µ—Ä–∞
  const data = await fetchNotes({ page: 1 });

  // üîπ –ü—Ä–µ—Ñ–µ—Ç—á–∏–º –∏—Ö –≤ –∫—ç—à –¥–ª—è React Query
  await queryClient.prefetchQuery({
    queryKey: ["notes", 1],
    queryFn: () => fetchNotes({ page: 1 }),
  });

  // üîπ –í–æ–∑–≤—Ä–∞—â–∞–µ–º –≥–æ—Ç–æ–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å –Ω–∞—á–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
  return (
    <HydrationBoundary state={dehydrate(queryClient)}>
      {/* ‚úÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ–¥–∞—ë–º initialNotes */}
      <NotesClient initialNotes={data.notes} />
    </HydrationBoundary>
  );
}
